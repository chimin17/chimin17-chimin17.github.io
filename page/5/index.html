<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>Chimin&#39;s Blog</title>
  <meta name="description" content="you are never wrong to do the right thing" />
  <meta name="keywords" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" href="/">
  <link rel="alternate" href="/atom.xml" title="Chimin's Blog">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="you are never wrong to do the right thing">
<meta property="og:type" content="website">
<meta property="og:title" content="Chimin&#39;s Blog">
<meta property="og:url" content="https://chimin17.github.io/page/5/index.html">
<meta property="og:site_name" content="Chimin&#39;s Blog">
<meta property="og:description" content="you are never wrong to do the right thing">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chimin&#39;s Blog">
<meta name="twitter:description" content="you are never wrong to do the right thing">
    
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href='//cdn.bootcss.com/node-waves/0.7.5/waves.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="/style.css">
  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
</head>

<body>
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script> 
  <header class="l_header">
	<div class='wrapper'>
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href='/' >
				Chimin's Blog
			</a>
			<div class='menu'>
				<ul class='h-list'>
					
						<li>
							<a class='flat-box nav-home' href='/'>
								Home
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-archives' href='/archives'>
								Archives
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-about' href='/about'>
								About
							</a>
						</li>
					
				</ul>
				<div class='underline'></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search" />
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a href='javascript:void(0)'><span class="icon icon-search flat-box"></span></a></li>
				
				<li class='s-menu'><a href='javascript:void(0)'><span class="icon icon-menu flat-box"></span></a></li>
			</ul>
		</div>
		
		<div class='nav-sub container container--flex'>
			<a class="logo" class="flat-box" href='javascript:void(0)'>
				Word of Forks
			</a>

			<ul class='switcher h-list'>
				<li class='s-comment'><a href='javascript:void(0)'><span class="icon icon-chat_bubble_outline flat-box"></span></a></li>
				<li class='s-top'><a href='javascript:void(0)'><span class="icon icon-arrow_upward flat-box"></span></a></li>
				<li class='s-toc'><a href='javascript:void(0)'><span class="icon icon-format_list_numbered flat-box"></span></a></li>
			</ul>
		</div>
	</div>
</header>
<aside class="menu-phone">
	<nav>
		
			<a href="/" class="nav-home nav">
				Home
			</a>
		
			<a href="/archives" class="nav-archives nav">
				Archives
			</a>
		
			<a href="/about" class="nav-about nav">
				About
			</a>
		
	</nav>
</aside>

    <script>setLoadingBarProgress(40);</script>
  <div class="l_body">
    <div class='container clearfix'>
      <div class='l_main'>
        
<section class="post-list">
	
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2017/12/29/ironman-2018-day10/">
        鐵人賽Day 10-坐標系統及webgis常用的坐標轉換
      </a>
    </h2>
    
    <time>
      Dec 29, 2017
    </time>
		
    
    <div class='cats'>
        <a href="/categories/web/">web</a>
    </div>

  </section>
  <section class="article typo">
	  <p><strong>坐標系統</strong>是GIS、大地測量及製圖的核心，而<strong>坐標轉換</strong>則是開發webGIS最常會遇到的課題。</p>
<blockquote>
<p>本文是參加鐵人賽的文章，同步發表於 <a href="https://ithelp.ithome.com.tw/users/20107816/ironman/1541" target="_blank" rel="noopener">“2018鐵人賽-30天打造我的WebGIS系列”</a></p>
</blockquote>
<h2 id="坐標系統"><a href="#坐標系統" class="headerlink" title="坐標系統"></a>坐標系統</h2><h3 id="大地坐標系統-地球是近似橢球"><a href="#大地坐標系統-地球是近似橢球" class="headerlink" title="大地坐標系統: 地球是近似橢球"></a>大地坐標系統: 地球是近似橢球</h3><p>由於地球是近似橢球，會有很多模式來描述這個橢球，以及球上面的點位坐標，描述這個橢球及球上位置的系統稱作<strong>大地坐標系統</strong>，需要定義的東西很多，包含幾何面的橢球參數、其他物理面及觀測資料的整合推估，GPS使用的WGS84經緯度屬此類，簡單來說，大地坐標系統是想描述橢球及球上面的位置。</p>
<h3 id="Map-projection-一切都是投影"><a href="#Map-projection-一切都是投影" class="headerlink" title="Map projection: 一切都是投影"></a>Map projection: 一切都是投影</h3><p>為了製造地圖，人們必須把近似橢球狀的地球投影到平面上，這個坐標系統稱作投影坐標系統，只要是地圖，一定會採用投影系統。<br>投影的方式有很多，麥卡托、藍柏特投影等等…，而從<a href="https://www.jasondavies.com/maps/transition/" target="_blank" rel="noopener">Map Projection Transitions</a>網站的各種投影機制的模擬圖可以看得出來，投影一定會有失真的情況，所以才會常常有以下新聞出現:</p>
<blockquote>
<p><a href="https://news.tvbs.com.tw/fun/728573" target="_blank" rel="noopener">400年來世界地圖都失真　各國大小差很多</a><br><a href="https://kknews.cc/zh-tw/news/899oqn.html" target="_blank" rel="noopener">格陵蘭島到底有多大，在地圖上一直是個謎</a></p>
</blockquote>
<p>投影系統一定都是有一好沒兩好，<strong>只有最適合的投影，沒有最好的投影</strong>，包含小小的台灣，因考量投影的誤差，也分了121中央子午線及119中央子午線的投影帶。</p>
<h3 id="TWD97"><a href="#TWD97" class="headerlink" title="TWD97"></a>TWD97</h3><p>我們直接來看看訂定及維護我國坐標系統的內政部怎麼說明TWD97(引述自<a href="https://gps.moi.gov.tw/SSCenter/Introduce/IntroducePage.aspx?Page=GPS9" target="_blank" rel="noopener">內政部</a>)</p>
<ul>
<li>新國家坐標系統之名稱命名為1997臺灣大地基準（TWD97），其建構係採用國際地球參考框架（International Terrestrial Reference Frame，簡稱為ITRF）。 ITRF為利用全球測站網之觀測資料成果推算所得之地心坐標系統，其方位採國際時間局（Bureau International de l’Heure` Heure，簡稱為BIH）定義在1984.0時刻之方位。</li>
<li>新國家坐標系統之參考橢球體採用1980年國際大地測量學與地球物理學協會（International Union of Geodesy and Geophysics，簡稱為IUGG）公布之參考橢球體（GRS80），其橢球參數如下：長半徑a=6378137公尺 扁率f=1/298.257222101</li>
<li>臺灣、琉球嶼、綠島、蘭嶼及龜山島等地區之投影方式採用橫麥卡托投影經差二度分帶，其中央子午線為東經121度，投影原點向西平移250,000公尺，中央子午線尺度比為0.9999；另澎湖、金門及馬祖等地區之投影方式，亦採用橫麥卡托投影經差二度分帶，其中央子午線定於東經119度，投影原點向西平移250,000公尺，中央子午線尺度比為0.9999。</li>
</ul>
<p>大致上可以劃兩個重點: (1)有定義所採用的大地系統、 (2)定義了投影，採橫麥卡托二度分帶，且分兩種投影帶(台灣本島121分帶、澎湖金門馬祖119分帶)</p>
<p>ps.好像也遇過117分帶(太平島、南沙等離島)、123分帶(釣魚台等)</p>
<h3 id="Web-Mercator"><a href="#Web-Mercator" class="headerlink" title="Web Mercator"></a>Web Mercator</h3><p>我國官方的坐標系統是TWD97，而在webgis中，為了互操作性通用的系統為Web Mercator(或稱Google Web Mercator、Spherical Mercator、WGS 84 Web Mercator)，相關說明可以及其前世今生可以參考<a href="https://read01.com/zh-tw/nBj3.html#.Wjk45lT1XOQ" target="_blank" rel="noopener">這篇文章</a>，它其實不是真正的麥卡托投影，儘管這個坐標系一度不被GIS專業人士接受，但目前已經廣泛使用於webgis。</p>
<h3 id="EPSG-Geodetic-Parameter-Dataset"><a href="#EPSG-Geodetic-Parameter-Dataset" class="headerlink" title="EPSG Geodetic Parameter Dataset"></a>EPSG Geodetic Parameter Dataset</h3><p>為了方便世界各國的坐標系統的轉換及辨識，一般使用EPSG Wkid來為坐標系統取代號，EPSG是(European Petroleum Survey Group) 的縮寫，EPSG定義了世界各國投影、坐標系統一系列的編號WKID(Well Known ID)，在台灣的我們常使用的編碼如下:</p>
<ul>
<li>WMS,WMTS等常使用的Web Mercator :<a href="https://epsg.io/4326" target="_blank" rel="noopener">EPSG:3857</a></li>
<li>kml, geojson默認使用的WGS84:<a href="https://epsg.io/4326" target="_blank" rel="noopener">EPSG:4326</a></li>
<li>TWD97 121分帶:<a href="https://epsg.io/3826" target="_blank" rel="noopener">EPSG:3826</a></li>
<li>TWD97 119分帶:<a href="https://epsg.io/3825" target="_blank" rel="noopener">EPSG:3825</a></li>
<li>TWD67 121分帶(台灣舊系統):<a href="https://epsg.io/3828" target="_blank" rel="noopener">EPSG:3828</a></li>
<li>TWD67 119分帶(台灣舊系統):<a href="https://epsg.io/3827" target="_blank" rel="noopener">EPSG:3827</a></li>
</ul>
<p>坐標系統在GIS資料中應該都要被記錄，像是shapefile的.prj檔，在解析資料時才能判讀，但在<strong>geojson、kml</strong>通常沒有類似prj的東西，<strong>默認使用EPSG:4326</strong> (也就是WGS84經緯度)</p>
<h3 id="很常搞混3857-or-4326嗎"><a href="#很常搞混3857-or-4326嗎" class="headerlink" title="很常搞混3857 or 4326嗎?"></a>很常搞混3857 or 4326嗎?</h3><p><a href="https://gis.stackexchange.com/questions/48949/epsg-3857-or-4326-for-googlemaps-openstreetmap-and-leaflet" target="_blank" rel="noopener">stackexchange</a>上有這麼一個問題：</p>
<blockquote>
<p>到底在Google Earth、Googlemaps、Openlayers、Leaflet應該是要使用EPSG:3857還是EPSG:4326? </p>
</blockquote>
<p>最佳答案是這樣：</p>
<p>有些事被混淆了…</p>
<blockquote>
<ul>
<li>Google Earth是 EPSG:4326也就是WGS84大地基準</li>
<li>Googlemaps是使用投影系統的EPSG:3857(其中EPSG:3857大地框架是WGS84，使用麥卡托投影)</li>
<li>我們使用的底圖圖磚的資料來源是使用EPSG:4326儲存</li>
<li>但是其發布的Web Service如WMS、WMTS是用EPSG:3857發布的</li>
</ul>
</blockquote>
<p>簡單來說，資料用EPSG:4326存，但地圖底圖Web Service都是使用EPSG:3857(因為地圖是平面，一定是要經過投影的呀！)<br>兩者坐標值域是差很多的：</p>
<ul>
<li>EPSG:4326就是熟悉的經緯度</li>
<li>EPSG:3857台灣地區值域都是八位數(13511000, 2870000)</li>
</ul>
<p><strong>通常我們只會使用EPSG:4326的資料但不會直接運算EPSG:3857</strong></p>
<h2 id="坐標轉換-使用proj4"><a href="#坐標轉換-使用proj4" class="headerlink" title="坐標轉換: 使用proj4"></a>坐標轉換: 使用proj4</h2><p>WMTS跟WMS主要使用EPSG:3857、geojson、kml通常採用EPSG:4326儲存資料，而我們取得的opendata資料常出現EPSG:3826甚至EPSG:3828等坐標系統….實務上一定會遇到這類問題。</p>
<p>所以我們需要坐標轉換！</p>
<p>proj4是OSGeo（Open Source Geospatial Foundation）維護的坐標轉換工具，有許多程式語言的版本，Javascirpt可以使用<a href="http://proj4js.org/" target="_blank" rel="noopener">proj4js</a>。</p>
<p>安裝<br><code>npm install proj4</code>  </p>
<p>建立test.js<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> var proj4=require(&apos;proj4&apos;);</span><br><span class="line">//首先定義坐標系統的參數(這些內容包含使用大地框架、橢球、投影等)，proj4轉換是根據這些參數</span><br><span class="line"> proj4.defs([</span><br><span class="line">  [</span><br><span class="line">    &apos;EPSG:4326&apos;,</span><br><span class="line">    &apos;+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees&apos;],</span><br><span class="line">  [</span><br><span class="line">    &apos;EPSG:3826&apos;,</span><br><span class="line">    &apos;+title=TWD97 TM2+proj=tmerc +lat_0=0 +lon_0=121 +k=0.9999 +x_0=250000 +y_0=0 +ellps=GRS80 +units=公尺 +no_defs&apos;</span><br><span class="line">  ],</span><br><span class="line">  [</span><br><span class="line">    &apos;EPSG:3828&apos;,</span><br><span class="line">    &apos;+proj=tmerc +lat_0=0 +lon_0=121 +k=0.9999 +x_0=250000 +y_0=0 +ellps=aust_SA&apos;</span><br><span class="line">  ]</span><br><span class="line">]);</span><br></pre></td></tr></table></figure></p>
<p> 轉換<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var EPSG3826 = new proj4.Proj(&apos;EPSG:3826&apos;);//TWD97 121分帶</span><br><span class="line">var EPSG3828 = new proj4.Proj(&apos;EPSG:3828&apos;);//TWD67 121分帶</span><br><span class="line">var EPSG4326 = new proj4.Proj(&apos;EPSG:4326&apos;);//WGS84</span><br><span class="line"></span><br><span class="line">//4326轉3826 (經緯度轉TWD97)</span><br><span class="line">var data1 = proj4(EPSG4326, EPSG3826, [121, 23]);</span><br><span class="line">//[250000,2544283.12479424]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//3826轉3828(TWD97轉TWD67)</span><br><span class="line">var data2 = proj4(EPSG4326, EPSG3826, data1);</span><br><span class="line">//[249171.10594810007, 2544488.5274230908]</span><br></pre></td></tr></table></figure></p>
<p>註：Proj4參數取自:<a href="http://mutolisp.logdown.com/posts/207563-taiwan-geodetic-coordinate-system-conversion" target="_blank" rel="noopener">台灣大地座標系統的轉換</a></p>
<p>執行<br><code>node test.js</code>  </p>
<h2 id="後記"><a href="#後記" class="headerlink" title="後記"></a>後記</h2><p>順著上面的案例，<br>我國有兩個時代的坐標系統TWD97跟TWD67<br>兩者在本島121分帶的差值大概是[dx,dy]=[8xx,2xx] (單位：公尺)<br>因此，如果在拿到一份資料時，如果發現X方向差了800公尺而Y方向差了200公尺，又沒有prj檔的狀況下，可能拿到的資料把TWD67跟TWD97弄混了，對坐標需要有一些敏銳度。</p>
<p>而文中一直提到，在geojson中通常都使用EPSG:4326，但我們取得國內政府平台提供的資料，應該是以適合我國的TWD97測量建置而來。</p>
<p>另外一個重點，如果在金門、澎湖、馬祖等坐標系統記得使用EPSG:3825(TWD97,119)或EPSG:3827(TWD67,119)喔，綜上所述，proj4在webgis一定會需要用到。</p>


    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/鐵人賽/">鐵人賽</a>
      
        <a href="/tags/GIS/">GIS</a>
      
        <a href="/tags/web/">web</a>
      
        <a href="/tags/proj4/">proj4</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2017/12/28/ironman-2018-day9/">
        鐵人賽Day 9-自己產製資料-地址定位part2
      </a>
    </h2>
    
    <time>
      Dec 28, 2017
    </time>
		
    
    <div class='cats'>
        <a href="/categories/web/">web</a>
    </div>

  </section>
  <section class="article typo">
	  <p>今天要介紹TGOS全國門牌定位服務。</p>
<blockquote>
<p>本文是參加鐵人賽的文章，同步發表於 <a href="https://ithelp.ithome.com.tw/users/20107816/ironman/1541" target="_blank" rel="noopener">“2018鐵人賽-30天打造我的WebGIS系列”</a></p>
</blockquote>
<h2 id="TGOS-Taiwan-Geospatial-One-Stop"><a href="#TGOS-Taiwan-Geospatial-One-Stop" class="headerlink" title="TGOS (Taiwan Geospatial One Stop)"></a>TGOS (Taiwan Geospatial One Stop)</h2><p>TGOS是內政部資訊中心維運的系統，整合了很多國內GIS資料，也提供了很多GIS相關API，除了需要申請token的API外，也有民眾版的查詢系統可供線上使用。<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/20107816kyqSsyu3bD.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/20107816kyqSsyu3bD.jpg"></p>
<h3 id="TGOS全國門牌定位服務"><a href="#TGOS全國門牌定位服務" class="headerlink" title="TGOS全國門牌定位服務"></a>TGOS全國門牌定位服務</h3><p><strong><a href="https://www.tgos.tw/TGOS/Web/Address/TGOS_Address.aspx" target="_blank" rel="noopener">全國門牌定位API服務</a></strong> 整合了國內戶政機關的門牌坐標資料，更新頻率很高，因為各縣市門牌資料在建置時驗收的標準滿高的，所以完整性跟正確性都很高。</p>
<p>更重要的是該API的模糊查詢的機制滿實用的:<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/20107816swpNRoftBV.png" alt="https://ithelp.ithome.com.tw/upload/images/20171227/20107816swpNRoftBV.png"></p>
<blockquote>
<p>假設今天輸入 <strong>[忠孝東路十段380號]</strong> ，這是一個不存在的門牌</p>
<ul>
<li>在Google Geocode可能傳給忠孝東路十段38號(常理上，380號跟38號可能差距天南地北)</li>
<li>TGOS可能傳給忠孝東路十段370號，這是一個在空間上比較有關聯的結果</li>
</ul>
<p>另外也可以選擇單雙號的鎖定(台灣門牌編制，單號通常在一側，雙號在另一側)，實際例子可能要請各位實際去操作看看</p>
</blockquote>
<h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><p>以下直接實際操作看看</p>
<ol>
<li>開啟服務網址，輸入門牌<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/20107816Ov1zv5zLdZ.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/20107816Ov1zv5zLdZ.jpg"></li>
</ol>
<p>2.系統會跳出一個地圖，並顯示坐標<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/20107816oG1QJseHlL.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/20107816oG1QJseHlL.jpg"></p>
<p><strong>[關於坐標值]</strong></p>
<blockquote>
<p>TGOS單筆查詢的坐標值是X是6位數,Y是7位數，跟先前幾天看到的121.XX,24.XX經緯度不一樣<br>這邊顯示的坐標系統是採用國內的TWD97，坐標系統這件事跟製圖有關，世界各國各區都會定義適合自己的局部坐標系統，關於坐標系統，後續打算攻略一番，就靜待下回分曉瞜。</p>
</blockquote>
<h3 id="批次操作"><a href="#批次操作" class="headerlink" title="批次操作"></a>批次操作</h3><p>TGOS門牌API是可以批次使用的(其實批次才是重點)，但是需要申請(網站上有提供教學)，申請後就可以使用啦，目前申請取得token後，好像一天可以使用1萬次。<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/20107816erY99zLo31.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/20107816erY99zLo31.jpg"></p>
<p>批次操作的選擇項目比較多，像是可以選輸出的坐標系統。<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/201078161pM3S7dvHi.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/201078161pM3S7dvHi.jpg"></p>
<h3 id="後記"><a href="#後記" class="headerlink" title="後記"></a>後記</h3><h4 id="什麼-坐標系統"><a href="#什麼-坐標系統" class="headerlink" title="什麼? 坐標系統 ?"></a>什麼? 坐標系統 ?</h4><p>這邊我們看到個資料坐標系統是<code>TWD97(EPSG:3826)</code>，而之前的提到的資料都是<code>WGS84(EPSG:4326)</code>，關於這些坐標的內容及轉換..，就明天見囉!</p>


    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/鐵人賽/">鐵人賽</a>
      
        <a href="/tags/GIS/">GIS</a>
      
        <a href="/tags/web/">web</a>
      
        <a href="/tags/opendata/">opendata</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2017/12/27/ironman-2018-day8/">
        鐵人賽Day 8-自己產製資料-地址定位part1
      </a>
    </h2>
    
    <time>
      Dec 27, 2017
    </time>
		
    
    <div class='cats'>
        <a href="/categories/web/">web</a>
    </div>

  </section>
  <section class="article typo">
	  <p>取得GIS資料的方式有很多，包含：</p>
<ul>
<li>取得實體檔或API(opendata等資料交換平台)</li>
<li>拿專業儀器測量或在地圖上數化而得：GPS、遙測、工程測量、etc.</li>
<li>地址定位：僅有poi的地址，可從線上資源取得地址的坐標</li>
</ul>
<p>今天要介紹的為<strong>地址定位</strong>，如果你也有一批資料有地址沒坐標，那就參考本篇吧^^。</p>
<blockquote>
<p>本文是參加鐵人賽的文章，同步發表於 <a href="https://ithelp.ithome.com.tw/users/20107816/ironman/1541" target="_blank" rel="noopener">“2018鐵人賽-30天打造我的WebGIS系列”</a></p>
</blockquote>
<p>以 <strong><a href="http://data.taipei/opendata/datalist/datasetMeta?oid=900f910f-a63c-46a0-a0c6-c2c1e55eef99" target="_blank" rel="noopener">臺北市各區農會地址一覽表</a></strong> 臺北市開放資料平臺下載的這份為例，就是具有<strong>地址</strong>，但沒有<strong>坐標</strong> 的資料。<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/20107816DaK7lkTNPs.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/20107816DaK7lkTNPs.jpg"></p>
<p>我們可以使用一些線上資源幫助我們把它加值為具空間資訊的GIS資料，包括:</p>
<ul>
<li>Google Fusion Table</li>
<li>內政部TGOS門牌對位系統</li>
<li>其它 (例如CartoDB也有支援Here的Geocoding，但需酌收點數)</li>
</ul>
<p>我們這兩天就來使用看看免費又好用的<strong>Google Fusion Table</strong>及<strong>內政部TGOS門牌對位系統</strong>，自己動手產生GIS資料。</p>
<hr>
<h3 id="Google-Fusion-Table："><a href="#Google-Fusion-Table：" class="headerlink" title="Google Fusion Table："></a>Google Fusion Table：</h3><ol>
<li><p>Fusion Table是在Google雲端上的一個功能，在Google雲端新增處可選擇<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/20107816IqfkzFy4YM.png" alt="https://ithelp.ithome.com.tw/upload/images/20171227/20107816IqfkzFy4YM.png"></p>
</li>
<li><p>如果找不到，請按 <strong>[連結更多應用程式]</strong> ，搜尋後找到<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/20107816NJQl8zf1YD.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/20107816NJQl8zf1YD.jpg"></p>
</li>
<li><p>fusion table有幾種匯入資料的方式，這邊直接把剛剛的csv匯入，可能要注意一下編碼，中文字常會出現Big5/UTF8的問題<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/20107816Fa1zxYIfh3.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/20107816Fa1zxYIfh3.jpg"></p>
</li>
</ol>
<ol>
<li><p>然後會是一些設定(沒啥問題就下一步然後完成)<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/20107816NtSRqap8Uk.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/20107816NtSRqap8Uk.jpg"></p>
</li>
<li><p>接著，我們選擇[File]–&gt;[Geocode]<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/20107816pYd8BJdePj.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/20107816pYd8BJdePj.jpg"></p>
</li>
<li><p>Geocode需要設定地址的欄位名稱，設定好後，就直接給它Run下去，需要執行一段時間<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/201078160FcpfGkEPe.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/201078160FcpfGkEPe.jpg"></p>
</li>
<li><p>然後…就完成了，我們切換至map頁籤看結果，<br>這邊其實可以作一些視覺化設定，包含marker符號及產生熱區圖(heat map)<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/201078165vK3FvChhI.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/201078165vK3FvChhI.jpg"></p>
</li>
</ol>
<ol>
<li>接著我們可以把資料匯出成kml，再透過<a href="https://ithelp.ithome.com.tw/articles/10193938" target="_blank" rel="noopener">[Day 7] 常見的GIS資料格式-轉換篇</a>的程式轉換成想要的格式<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(&apos;fs&apos;);</span><br><span class="line">var KmlStream = require(&quot;kml-stream&quot;);</span><br><span class="line">var data = fs.createReadStream(&apos;./out.kml&apos;).pipe(new KmlStream()).on(&apos;data&apos;, function (d) &#123;</span><br><span class="line">    console.log(d);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>在Google Earth可以看到匯出的成果:<br><img src="https://ithelp.ithome.com.tw/upload/images/20171227/20107816JQLHpG6d2A.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171227/20107816JQLHpG6d2A.jpg"></p>
<hr>
<h3 id="後記"><a href="#後記" class="headerlink" title="後記"></a>後記</h3><p>fusion table是一個快速地址對位的工具，但由於Google門牌資料庫完整度及更新頻率並不是這麼高，正確性及完整性可以還有一些限制，但已經可以滿足大多數需求，有了這個功能，只要手邊有地址，就可以<strong>自己的GIS資料自己產啦</strong>。</p>
<p>而fusion table其實是基於<a href="https://developers.google.com/maps/documentation/geocoding/intro?hl=zh-tw" target="_blank" rel="noopener">Google Geocode Api</a>，所以每天只能request2500筆。</p>
<p>另外，這幾天在蒐集資料時，發現<a href="https://kuro.tw/posts/2015/10/15/using-google-fusion-table-without-writing-code-or-topic-maps/" target="_blank" rel="noopener">Kuro大大</a>之前也非常完整的介紹Fusion Table，或許大家也可以參考唷!</p>


    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/鐵人賽/">鐵人賽</a>
      
        <a href="/tags/GIS/">GIS</a>
      
        <a href="/tags/web/">web</a>
      
        <a href="/tags/google/">google</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2017/12/26/ironman-2018-day7/">
        鐵人賽Day 7-常見的GIS資料格式-轉換篇
      </a>
    </h2>
    
    <time>
      Dec 26, 2017
    </time>
		
    
    <div class='cats'>
        <a href="/categories/web/">web</a>
    </div>

  </section>
  <section class="article typo">
	  <p>昨天介紹了geojson、shapefile、kml基本概念，今天我們簡單用npm上面的工具寫個簡單轉換，有關node.js的安裝及使用請各位參考其他線上教學資源，這邊我們就直接使用囉。</p>
<h2 id="gt-本文是參加鐵人賽的文章，同步發表於-“2018鐵人賽-30天打造我的WebGIS系列”"><a href="#gt-本文是參加鐵人賽的文章，同步發表於-“2018鐵人賽-30天打造我的WebGIS系列”" class="headerlink" title="&gt; 本文是參加鐵人賽的文章，同步發表於 “2018鐵人賽-30天打造我的WebGIS系列”"></a>&gt; 本文是參加鐵人賽的文章，同步發表於 <a href="https://ithelp.ithome.com.tw/users/20107816/ironman/1541" target="_blank" rel="noopener">“2018鐵人賽-30天打造我的WebGIS系列”</a></h2><h3 id="geojson資料轉換工具："><a href="#geojson資料轉換工具：" class="headerlink" title="geojson資料轉換工具："></a>geojson資料轉換工具：</h3><p>這邊使用npm上的<a href="https://www.npmjs.com/package/geojson2" target="_blank" rel="noopener">geojson2</a>，直接安裝：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install geojson2</span><br></pre></td></tr></table></figure>
<p>建立test.js，寫一個geojson2.kml的轉換<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var geojson2 = require(&apos;geojson2&apos;);</span><br><span class="line">geojson2.kml(&apos;test.geojson&apos;, &apos;./out.kml&apos;, function (err) &#123;</span><br><span class="line">    console.log(&quot;finish&quot;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>執行<br><code>node test.js</code></p>
<p>結果out.kml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span><br><span class="line">&lt;kml xmlns=&quot;http://www.opengis.net/kml/2.2&quot;&gt;</span><br><span class="line">&lt;Document id=&quot;root_doc&quot;&gt;</span><br><span class="line">&lt;Folder&gt;&lt;name&gt;OGRGeoJSON&lt;/name&gt;</span><br><span class="line">  &lt;Placemark&gt;</span><br><span class="line">	&lt;name&gt;Dinagat Islands&lt;/name&gt;</span><br><span class="line">      &lt;Point&gt;&lt;coordinates&gt;125.6,10.1&lt;/coordinates&gt;&lt;/Point&gt;</span><br><span class="line">  &lt;/Placemark&gt;</span><br><span class="line">&lt;/Folder&gt;</span><br><span class="line">&lt;/Document&gt;&lt;/kml&gt;</span><br></pre></td></tr></table></figure></p>
<p>geojson2這個模組，包含了四個子功能</p>
<ul>
<li>geojson2csv</li>
<li>geojson2shape</li>
<li>geojson2kml</li>
<li>geojson2topojson</li>
</ul>
<p>有需要可以自行測試！</p>
<blockquote>
<p>其中官方文件提到，若要輸出kml and shp. 須先安裝gdal<br>Run ‘brew install gdal’ on OSX,<br>or ‘sudo apt-get install gdal’ on linux.</p>
</blockquote>
<hr>
<h3 id="shapefile資料轉換工具："><a href="#shapefile資料轉換工具：" class="headerlink" title="shapefile資料轉換工具："></a>shapefile資料轉換工具：</h3><p>這邊一樣使用NPM上的<a href="https://www.npmjs.com/package/shp2json" target="_blank" rel="noopener">shp2json</a></p>
<blockquote>
<p>一樣須先安裝gdal<br>Run ‘brew install gdal’ on OSX,<br>or ‘sudo apt-get install gdal’ on linux.</p>
</blockquote>
<p>安裝<br><code>npm install shp2json.</code></p>
<p>建立test.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var toJSON = require(&apos;shp2json&apos;);</span><br><span class="line">var result = toJSON.fromShpFile(&apos;out.shp&apos;).pipe(process.stdout);</span><br><span class="line">console.log(result);</span><br></pre></td></tr></table></figure></p>
<p>執行<br><code>node test.js</code></p>
<p>結果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;type&quot;: &quot;FeatureCollection&quot;, </span><br><span class="line">    &quot;features&quot;: </span><br><span class="line">    [</span><br><span class="line">        &#123; </span><br><span class="line">            &quot;type&quot;: &quot;Feature&quot;, </span><br><span class="line">            &quot;properties&quot;: &#123; &quot;name&quot;: &quot;Dinagat Islands&quot; &#125;, </span><br><span class="line">            &quot;geometry&quot;: &#123; &quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [125.6, 10.1] &#125; </span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="kml資料轉換工具："><a href="#kml資料轉換工具：" class="headerlink" title="kml資料轉換工具："></a>kml資料轉換工具：</h3><p>使用NPM上的<a href="https://www.npmjs.com/package/kml-stream" target="_blank" rel="noopener">kml-stream</a></p>
<p>安裝kml-stream<br><code>npm install kml-stream</code></p>
<p>test.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(&apos;fs&apos;);</span><br><span class="line">var KmlStream = require(&quot;kml-stream&quot;);</span><br><span class="line">var data = fs.createReadStream(&apos;./out.kml&apos;).pipe(new KmlStream()).on(&apos;data&apos;, function (d) &#123;</span><br><span class="line">    console.log(d);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>執行<br><code>node test.js</code></p>
<p>結果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    type: &apos;Feature&apos;,</span><br><span class="line">    properties: &#123; &#125;,</span><br><span class="line">    geometry: &#123; type: &apos;Point&apos;, coordinates: [125.6, 10.1] &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="後記"><a href="#後記" class="headerlink" title="後記"></a>後記</h3><p>基本上只要掌握了這三類資料互轉，大多數webgis線上資源的格式應該幾乎可以掌握了，後續如果真的有其他GIS資料轉換及讀取的問題，建議可進一步研究專業的GIS軟體：<a href="https://www.qgis.org/en/site/" target="_blank" rel="noopener">QGIS</a>，由於本次鐵人賽的目標是快速上手webgis，比較可惜無法操作太多QGIS，QGIS無論在轉檔、分析及處理等功能都很強大，可以自行試看看唷。</p>


    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/鐵人賽/">鐵人賽</a>
      
        <a href="/tags/GIS/">GIS</a>
      
        <a href="/tags/web/">web</a>
      
        <a href="/tags/Node/">Node</a>
      
        <a href="/tags/javascript/">javascript</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class='post-wrapper'>
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2017/12/25/ironman-2018-day6/">
        鐵人賽Day 6-常見的GIS資料格式
      </a>
    </h2>
    
    <time>
      Dec 25, 2017
    </time>
		
    
    <div class='cats'>
        <a href="/categories/web/">web</a>
    </div>

  </section>
  <section class="article typo">
	  <p>前兩天我們先用CARTO(CartoDB)實作了一些基本的GIS資料視覺化，接觸了GIS資料。</p>
<p>延續 <strong><a href="https://ithelp.ithome.com.tw/articles/10192948" target="_blank" rel="noopener">[Day3]  談互操作性及Web Map Service 標準</a>議題</strong>，我們在處理資料時可能會遇到各種GIS格式，今日就來攻略幾種<strong>web常用的GIS資料格式</strong>。</p>
<blockquote>
<p>本文是參加鐵人賽的文章，同步發表於 <a href="https://ithelp.ithome.com.tw/users/20107816/ironman/1541" target="_blank" rel="noopener">“2018鐵人賽-30天打造我的WebGIS系列”</a></p>
</blockquote>
<h2 id="先釐清一下資料型態"><a href="#先釐清一下資料型態" class="headerlink" title="先釐清一下資料型態"></a>先釐清一下資料型態</h2><p>根據教科書，所謂GIS資料就是具備空間資訊的資料，依照資料型態可以分成兩類</p>
<ul>
<li>網格資料(raster)</li>
<li>向量資料(vector)</li>
</ul>
<h3 id="網格資料："><a href="#網格資料：" class="headerlink" title="網格資料："></a>網格資料：</h3><p>網格資料指的通常是影像類型等<strong>規則網格</strong>的資料，例如衛星影像、高程模型(用來表示地形)，以像元(pixel)為基礎，每個pixel會有一些資訊如R,G,B, 或是深度、高度，等，賦予每一個pixel對應的空間坐標，就是一個網格式GIS資料，而賦予坐標的做法通常是定義<strong>網格大小、起始網格坐標、以及方向</strong>，定義這些資訊的檔案稱作 <strong><a href="http://webhelp.esri.com/arcims/9.3/General/topics/author_world_files.htm" target="_blank" rel="noopener">world file</a></strong>，常用的格式如geotiff、tiff、jpg、bmp等影像檔具有world file都屬於此類。</p>
<h3 id="向量資料："><a href="#向量資料：" class="headerlink" title="向量資料："></a>向量資料：</h3><p>比起網格式資料可能都是使用專業人員處理好的資料，向量式資料在應用上常見得多，又依表示方法分成：<strong>點、線、面</strong>（註）</p>
<blockquote>
<p>註：點線面是統稱，在2D 又可細分為multi points, multi polygon…etc. 在3D GIS的世界，相關格式另有一片天….。</p>
</blockquote>
<hr>
<h2 id="本篇主要談的資料格式屬於向量式資料"><a href="#本篇主要談的資料格式屬於向量式資料" class="headerlink" title="本篇主要談的資料格式屬於向量式資料"></a>本篇主要談的資料格式屬於向量式資料</h2><h3 id="geojson-http-geojson-org"><a href="#geojson-http-geojson-org" class="headerlink" title="geojson (http://geojson.org/)"></a>geojson (<a href="http://geojson.org/" target="_blank" rel="noopener">http://geojson.org/</a>)</h3><p>geojson我們在第二天的範例中就已經在地圖上介接了一個開放資料範例，而跟前幾天提到GIS常用的OGC標準不同，<strong>geojson非OGC標準，是由IETF(Internet Engineering Task Force)組織訂定的</strong>，因為是json物件的方式表現，使用起來可說是簡單好用，於webgis廣為流通，目前版本的<a href="https://en.wikipedia.org/wiki/GeoJSON" target="_blank" rel="noopener">geojson(RFC 7946)</a>具有以下特徵：</p>
<ul>
<li>JSON，流通方便</li>
<li><p>一個geojson結構如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;type&quot;: &quot;Feature&quot;,</span><br><span class="line">  &quot;geometry&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;Point&quot;,</span><br><span class="line">    &quot;coordinates&quot;: [125.6, 10.1]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;properties&quot;: &#123;</span><br><span class="line">    &quot;name&quot;: &quot;Dinagat Islands&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>幾何樣態（geometry Type）：Point, LineString, Polygon, MultiPoint, MultiLineString, and MultiPolygon</p>
</li>
<li>坐標(coordinates)：不同幾何形態有不同坐標值記錄方式，可以參考 <strong><a href="https://en.wikipedia.org/wiki/GeoJSON" target="_blank" rel="noopener">wiki範例</a></strong>，而且並沒有定義投影坐標系統的欄位，通常默認為EPSG4326(也就是wgs84經緯度)</li>
<li>屬性(properties)：在properties以key-value方式記錄每一筆資料的屬性欄位</li>
</ul>
<h3 id="ESRI-shapefile-shp"><a href="#ESRI-shapefile-shp" class="headerlink" title="ESRI shapefile(shp)"></a>ESRI shapefile(shp)</h3><p>shapefile在GIS領域廣為使用多年，目前仍廣泛使用中，它是GIS應用軟體供應商ESRI定義的格式，亦已部分公開相關結構，大多數GIS軟體(如QGIS、Arcgis等)也都支援。<br>要解析shapefile，可參考github上有許多shapefile library，而一個shapefile通常包含很多附屬檔案(<a href="https://zh.wikipedia.org/wiki/Shapefile#cite_note-esri98-1" target="_blank" rel="noopener">wiki</a>)：</p>
<ul>
<li>Shapefile圖形格式 (.shp)</li>
<li>Shapefile圖形索引格式(.shx)</li>
<li>Shapefile屬性格式(.dbf)，屬性資料庫</li>
<li>Shapefile投影格式(.prj)，紀錄坐標系統</li>
<li>Shapefile空間索引格式(.sbn)</li>
</ul>
<p>一個shapefile只會有一種幾何形態，共支援Point, Polyline, Polygon, 等13類的幾何型態資料，更多shape資料問題可參考<a href="https://zh.wikipedia.org/wiki/Shapefile#cite_note-esri98-1" target="_blank" rel="noopener">wiki</a>。</p>
<p>這邊要特別分享一個小小使用經驗：</p>
<blockquote>
<p>shapefile因為具有(.prj)檔案記錄投影坐標系統的特性，與geojson有個不同的地方在於它可以使用不同的坐標系統(一般來說geojson都是使用ESPG4326，也就是wgs84經緯度)，我們拿到一份shapefile可能會是各式各樣坐標系統，這些坐標值是存在shp內，<strong>當我們偶爾會拿到沒有prj檔的shapefile時，可能會遇到對於shp內坐標值到底是啥而一頭霧水的現象，這時便需要經驗判斷資料的坐標系統喔！</strong>(關於坐標系統，預計過兩天再來攻略^^)</p>
</blockquote>
<h2 id="kml"><a href="#kml" class="headerlink" title="kml"></a>kml</h2><p>kml是OGC規範格式，廣泛用於Google Earth等平台上，它是xml方式表達GIS資料，並且包含了其在Google Earth上的樣式資料，基本上都使用ESPG4326的經緯度坐標，範例如下(<a href="https://en.wikipedia.org/wiki/Keyhole_Markup_Language" target="_blank" rel="noopener">wiki</a>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;kml xmlns=&quot;http://www.opengis.net/kml/2.2&quot;&gt;</span><br><span class="line">&lt;Document&gt;</span><br><span class="line">&lt;Placemark&gt;</span><br><span class="line">  &lt;name&gt;New York City&lt;/name&gt;</span><br><span class="line">  &lt;description&gt;New York City&lt;/description&gt;</span><br><span class="line">  &lt;Point&gt;</span><br><span class="line">    &lt;coordinates&gt;-74.006393,40.714172,0&lt;/coordinates&gt;</span><br><span class="line">  &lt;/Point&gt;</span><br><span class="line">&lt;/Placemark&gt;</span><br><span class="line">&lt;/Document&gt;</span><br><span class="line">&lt;/kml&gt;</span><br></pre></td></tr></table></figure></p>
<p>在我過去使用kml的經驗，Google Earth對於kml在樣式屬性上實在非常具有彈性，他甚至可以定義其在Google Earth上的Popup內容、視角、事件等等，個人覺得算是很單純但又很難掌握(ㄊㄠˇ 一ㄢˋ)的格式(樣式部分)</p>
<h2 id="topojson"><a href="#topojson" class="headerlink" title="topojson"></a>topojson</h2><p>topojson是geojson的擴充，大致上是基於geojson但具<strong>資訊壓縮</strong>並考量<strong>位相關係</strong>的(<a href="https://en.wikipedia.org/wiki/Geospatial_topology" target="_blank" rel="noopener">topology</a>)的資料格式(<a href="https://github.com/topojson/topojson-specification#1-introduction" target="_blank" rel="noopener">請參考topojson spec文件</a>)，<strong>廣泛用於webgis及d3.js資料視覺化</strong>(作者同時也是d3.js作者Mike Bostock)，關於topojson詳細的規格可以直接參考文件，在這邊我們先快速來看看一個Taiwan.TopoJSON範例(因長度關係，請直接前往<a href="https://github.com/jason2506/Taiwan.TopoJSON/blame/master/topojson/towns/towns-09007.json" target="_blank" rel="noopener">github上的範例</a>)。</p>
<p>拿到資料後，我們把資料複製到<a href="http://jsoneditoronline.org" target="_blank" rel="noopener">json edirtor</a>檢視：<br><img src="https://ithelp.ithome.com.tw/upload/images/20171225/201078169w5CgPveJz.jpg" alt="https://ithelp.ithome.com.tw/upload/images/20171225/201078169w5CgPveJz.jpg"></p>
<p>從資料格式架構中可以看到，topojson相較於geojson多增加了幾個項目:bbox、transform、arcs</p>
<ul>
<li>bbox: 記錄的是這份geojson的邊界</li>
<li>transfrom: 記錄<strong>兩個尺度</strong>及<strong>兩個平移參數</strong>，在topojson中為了減少記錄位數，坐標都是用int方式記錄，再靠transform參數還原</li>
<li>arcs: 記錄資料中的邊，arcs分兩個部分，<strong>一個是最外層的arcs記錄所有的邊</strong>，<strong>第二個是每個幾何物件中的arcs記錄的為arc index</strong>，每個幾何物件內的arcs都參照最外層arcs，如此是以共邊的概念記錄每個物件的幾何，減低資料量並保有位相關係(topology)</li>
<li>objects: GIS資料物件陣列，包含幾何及屬性</li>
</ul>
<h2 id="後記"><a href="#後記" class="headerlink" title="後記"></a>後記</h2><p>geojson、shapefile、kml在webgis中最常被用到，資料交換也常依賴這幾類格式，大多數webgis平台都支援這些資料形式，因此大家一定會碰到，今天先介紹這些格式，明天預計來攻略這幾類的資料轉換(這應該才是最重要的^^)。</p>


    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/鐵人賽/">鐵人賽</a>
      
        <a href="/tags/GIS/">GIS</a>
      
        <a href="/tags/web/">web</a>
      
        <a href="/tags/json/">json</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
</section>


  <nav id="page-nav">
    
    <a class="prev" rel="prev" href="/page/4/">
      <span class="icon icon-chevron-left"></span>
      <span class="text">Previous</span>
    </a>
    
    
    <a class="next" rel="next" href="/page/6/">
      <span class="text">Next</span>
      <span class="icon icon-chevron-right"></span>
    </a>
    
  </nav>
  

      </div>
      <aside class='l_side'>
        
  <section class='m_widget links'>
<div class='header'>Links</div>
<div class='content'>
    <ul class="entry">
    
        <li><a class="flat-box" target="_blank" href="https://ithelp.ithome.com.tw/users/20107816/ironman/1797">
            <div class='name'>30天精通GIS資料分析-使用Python</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://ithelp.ithome.com.tw/users/20107816/ironman/1541">
            <div class='name'>30天打造我的WebGIS</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://developer.tomtom.com/">
            <div class='name'>TomTom for developer</div>
        </a></li>
    
    </ul>
</div>
</section>

  <section class='m_widget categories'>
<div class='header'>Categories</div>
<div class='content'>
    
    <ul class="entry">
    
        <li><a class="flat-box" href="/categories/data-analysis/"><div class='name'>data analysis</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/python/"><div class='name'>python</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/web/"><div class='name'>web</div><div class='badget'>28</div></a></li>
    
    </ul>
    
</div>
</section>

  
<div class="m_widget tagcloud">
    <div class="header">Tags</div>
    <div class='content'>
        <a href="/tags/D3/" style="font-size: 14px; color: #808080">D3</a> <a href="/tags/GIS/" style="font-size: 20px; color: #000">GIS</a> <a href="/tags/Google/" style="font-size: 15.2px; color: #666">Google</a> <a href="/tags/Hexo/" style="font-size: 14px; color: #808080">Hexo</a> <a href="/tags/Leaflet/" style="font-size: 14px; color: #808080">Leaflet</a> <a href="/tags/Mapillary/" style="font-size: 14px; color: #808080">Mapillary</a> <a href="/tags/Mongodb/" style="font-size: 14px; color: #808080">Mongodb</a> <a href="/tags/Node/" style="font-size: 14px; color: #808080">Node</a> <a href="/tags/PostgreSQL/" style="font-size: 14px; color: #808080">PostgreSQL</a> <a href="/tags/Turf-js/" style="font-size: 15.2px; color: #666">Turf.js</a> <a href="/tags/WebGL/" style="font-size: 14px; color: #808080">WebGL</a> <a href="/tags/geojson/" style="font-size: 16.4px; color: #4d4d4d">geojson</a> <a href="/tags/github/" style="font-size: 14px; color: #808080">github</a> <a href="/tags/google/" style="font-size: 14px; color: #808080">google</a> <a href="/tags/javascript/" style="font-size: 14px; color: #808080">javascript</a> <a href="/tags/json/" style="font-size: 14px; color: #808080">json</a> <a href="/tags/leaflet/" style="font-size: 17.6px; color: #333">leaflet</a> <a href="/tags/opendata/" style="font-size: 14px; color: #808080">opendata</a> <a href="/tags/proj4/" style="font-size: 14px; color: #808080">proj4</a> <a href="/tags/web/" style="font-size: 18.8px; color: #1a1a1a">web</a> <a href="/tags/鐵人賽/" style="font-size: 20px; color: #000">鐵人賽</a>
    </div>
</div>



      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/chimin17" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="https://linkedin.com/in/chi-min-chiu-aba7a5148/" class="social linkedin"
          target="_blank" rel="external">
          <span class="icon icon-linkedin"></span>
        </a>
      
    
  </div>
  
  <div>Theme <a href='https://github.com/stkevintan/hexo-theme-material-flow' class="codename">MaterialFlow</a> designed by <a href="http://keyin.me/" target="_blank">Kevin Tan</a>.</div>
  
</footer>


  <script>setLoadingBarProgress(80);</script>
  
<script>
  var disqus_shortname = 'chimin17';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src='//cdn.bootcss.com/node-waves/0.7.5/waves.min.js'></script>
<script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script>
<script src="/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
  var ROOT = "/"||"/";
  if(!ROOT.endsWith('/'))ROOT += '/';
</script>
<script src="/js/search.js"></script>
<script src="/js/app.js"></script>


  <script>setLoadingBarProgress(100);</script>
</body>
</html>
